---
description: When it is necessary to use or understand the data file format recorded by BatteryRecorder
alwaysApply: false
---
# BatteryRecorder 数据文件格式

本文档详细描述了 `BatteryRecorder` 应用所生成的数据文件的格式，旨在为数据文件的使用者提供清晰的解析指南。

## 文件命名规则

数据文件名由两部分组成，格式为 `[第一条记录的时间戳][+/-].txt`。

-   **`[第一条记录的时间戳]`**: 一个长整型（Long）数字，代表该文件中第一条记录的 Unix 时间戳，单位为毫秒 (ms)。
-   **`[+/-]`**: 一个符号，用于标识记录期间的电池状态。
    -   `+`: 表示电池正在**放电**（消耗电量）。
    -   `-`: 表示电池正在**充电**。
-   **新文件创建**: 当电流方向发生改变时（即从充电切换到放电，或从放电切换到充电），应用会创建一个新的数据文件。

## 文件内容结构

-   文件为纯文本格式（`.txt`）。
-   每行包含一条完整的记录。
-   每条记录中的各个字段由英文逗号 (`,`) 分隔。

## 记录字段详解

每行记录包含以下五个字段，顺序固定：

| 字段名称 | 数据类型 | 单位 | 说明 |
| :--- | :--- | :--- | :--- |
| `时间戳` | Long | 毫秒 (ms) | 记录该条数据时的 Unix 时间戳。 |
| `电流` | Integer | 原始值 | 从系统文件中读取的瞬时电流原始值。 |
| `电压` | Integer | 原始值 | 从系统文件中读取的瞬时电压原始值。 |
| `前台包名` | String | 无 | 记录时前台正在运行的应用程序的包名。 |
| `电量` | Integer | % | 电池电量百分比，整数范围为 0-100。 |

## 示例

以下是一个完整的文件名和文件内容示例，用于展示真实的数据格式。

**文件名示例:**

```
1672531200000+.txt
```

> 这表示文件记录的是放电状态的数据，第一条记录的时间戳为 `1672531200000`。

**文件内容示例:**

```
1672531200000,500,4231,com.android.launcher,95
1672531205000,510,4230,com.some.app,95
1672531210000,495,4229,com.some.app,94
```

## 实际功率计算

文件中的 `电流` 和 `电压` 字段记录的均为从系统文件中直接读取的原始整数值，不带单位。

实际功率的计算在 App 端完成，其计算公式如下：

`实际功率 = (文件中的电流值) * (文件中的电压值) * (App中设置的校准值)`

**说明**:
- **`文件中的电流值`**: 对应记录中的 `电流` 字段。
- **`文件中的电压值`**: 对应记录中的 `电压` 字段。
- **`App中设置的校准值`**: 这是一个在 App 设置中由用户定义的浮点数。它可以是正数、负数或小数，用于校准最终的功率值。例如，可以将其设置为 `-1` 来反转功率的正负号，以匹配不同设备的标准。# BatteryRecorder 数据文件格式

本文档详细描述了 `BatteryRecorder` 应用所生成的数据文件的格式，旨在为数据文件的使用者提供清晰的解析指南。

## 文件命名规则

数据文件名由两部分组成，格式为 `[第一条记录的时间戳][+/-].txt`。

-   **`[第一条记录的时间戳]`**: 一个长整型（Long）数字，代表该文件中第一条记录的 Unix 时间戳，单位为毫秒 (ms)。
-   **`[+/-]`**: 一个符号，用于标识记录期间的电池状态。
    -   `+`: 表示电池正在**放电**（消耗电量）。
    -   `-`: 表示电池正在**充电**。
-   **新文件创建**: 当电流方向发生改变时（即从充电切换到放电，或从放电切换到充电），应用会创建一个新的数据文件。

## 文件内容结构

-   文件为纯文本格式（`.txt`）。
-   每行包含一条完整的记录。
-   每条记录中的各个字段由英文逗号 (`,`) 分隔。

## 记录字段详解

每行记录包含以下五个字段，顺序固定：

| 字段名称 | 数据类型 | 单位 | 说明 |
| :--- | :--- | :--- | :--- |
| `时间戳` | Long | 毫秒 (ms) | 记录该条数据时的 Unix 时间戳。 |
| `电流` | Integer | 原始值 | 从系统文件中读取的瞬时电流原始值。 |
| `电压` | Integer | 原始值 | 从系统文件中读取的瞬时电压原始值。 |
| `前台包名` | String | 无 | 记录时前台正在运行的应用程序的包名。 |
| `电量` | Integer | % | 电池电量百分比，整数范围为 0-100。 |

## 示例

以下是一个完整的文件名和文件内容示例，用于展示真实的数据格式。

**文件名示例:**

```
1672531200000+.txt
```

> 这表示文件记录的是放电状态的数据，第一条记录的时间戳为 `1672531200000`。

**文件内容示例:**

```
1672531200000,500,4231,com.android.launcher,95
1672531205000,510,4230,com.some.app,95
1672531210000,495,4229,com.some.app,94
```

## 实际功率计算

文件中的 `电流` 和 `电压` 字段记录的均为从系统文件中直接读取的原始整数值，不带单位。

实际功率的计算在 App 端完成，其计算公式如下：

`实际功率 = (文件中的电流值) * (文件中的电压值) * (App中设置的校准值)`

**说明**:
- **`文件中的电流值`**: 对应记录中的 `电流` 字段。
- **`文件中的电压值`**: 对应记录中的 `电压` 字段。
- **`App中设置的校准值`**: 这是一个在 App 设置中由用户定义的浮点数。它可以是正数、负数或小数，用于校准最终的功率值。例如，可以将其设置为 `-1` 来反转功率的正负号，以匹配不同设备的标准。